<div class="my-orders-page">
  <!-- Breadcrumb -->
  <app-breadcrumb [items]="breadcrumbItems"></app-breadcrumb>

  <!-- Page Header -->
  <div class="page-header">
    <div class="container">
      <div class="header-info">
        <h1 class="page-title">
          {{ 'PAGES.MY_ORDERS.SECTION_TITLE' | translate }}
        </h1>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading()" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando tus compras...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error() && !loading()" class="error-container">
    <i class="fas fa-exclamation-triangle"></i>
    <h3>Error al cargar las compras</h3>
    <p>{{ error() }}</p>
    <button class="btn btn-primary" (click)="loadOrders()">
      Reintentar
    </button>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading() && !error() && orders().length === 0" class="empty-state">
    <i class="fas fa-shopping-bag"></i>
    <h3>Aún no realizaste ninguna compra</h3>
    <p>Cuando realices tu primera compra, aparecerá acá</p>
    <a routerLink="/" class="btn btn-primary">
      Ir a la tienda
    </a>
  </div>

  <!-- Orders List -->
  <div *ngIf="!loading() && !error() && orders().length > 0" class="orders-container">
    
    <!-- Orders Grid -->
    <div class="orders-grid">
      <div 
        *ngFor="let order of orders()" 
        class="order-card"
        (click)="viewOrderDetail(order.id)"
      >
        <!-- Order Header -->
        <div class="order-card-header">
          <div class="order-info">
            <span class="order-title">{{'COMMON.ORDER' | translate}}</span>
            <span class="order-id">
              <i class="fas fa-hashtag"></i>{{ order.public_id }}
            </span>
            <span class="order-date">
              <i class="far fa-calendar"></i>
              {{ formatDate(order.created_at) }}
            </span>
          </div>
          <div class="order-status">
            <button class="btn btn-primary btn-sm">
              <i class="fas fa-eye"></i>
              Ver detalle
            </button>
            <span class="status-badge" [ngClass]="getStatusClass(order.status)">
              {{ getStatusLabel(order.status) }}
            </span>
          </div>
        </div>

        <!-- Order Body -->
        <div class="order-card-body">
          <div class="order-details">
            <div class="detail-item">
              <div class="detail-title">
                <i class="fas fa-box"></i>
                <span>Productos</span>
              </div>
              <div 
                *ngFor="let item of order.items" 
                class="order-items"
              >     
                <div class="order-item">{{ item.quantity }} &times; {{ item.listing_title }}</div>
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-title">
                <i class="fas fa-credit-card"></i>
                <span>Estado del pago</span>
              </div>              
              <span 
                class="payment-status" 
                [ngClass]="getPaymentStatusClass(order.payment_status)"
              >
                {{ getPaymentStatusLabel(order.payment_status) }}
              </span>
            </div>
            <div class="detail-item">
              <div class="detail-title">
                <i class="fas fa-truck"></i>
                <span>Método de entrega</span>
              </div>               
              <span>{{ getDeliveryMethodLabel(order.delivery_method_type) }}</span>
            </div>  
            <div class="detail-item">
              <div class="detail-title">
                <i class="fas fa-dollar-sign"></i>
                <span>Total</span>
              </div>               
              <span class="total-value">{{ formatPrice(order.total) }}</span>
            </div>          
          </div>                   
        </div>        
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-container" *ngIf="totalPages > 1">
      <app-pagination
        [currentPage]="currentPage"
        [totalPages]="totalPages"
        [totalItems]="totalItems"
        (pageChange)="onPageChange($event)"
      ></app-pagination>
    </div>
  </div>
</div>